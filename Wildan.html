<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#044166"> 
    <title>Undangan Khitan - Wildan Firmansyah</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cherry+Swash:wght@400;700&family=League+Spartan:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        :root {
            --bg-gradient: radial-gradient(at center center, #0487BA 0%, #044166 100%);
            --gold: #D4AF37;
            --gold-light: #FFD700;
            --white: #ffffff;
            --dark-blue: #061B3A;
            --neon-blue: #00f7ff;
            --neon-pink: #ff00bb;
        }

        /* RESET & MOBILE OPTIMIZATION */
        html, body { overflow-x: hidden; touch-action: pan-y; -webkit-font-smoothing: antialiased; }
        body { font-family: 'League Spartan', sans-serif; background: var(--bg-gradient); color: var(--white); min-height: 100vh; position: relative; }

        .mobile-container { max-width: 480px; margin: 0 auto; background: transparent; position: relative; z-index: 2; }
        .font-decor { font-family: 'Cherry Swash', cursive; color: var(--gold); }
        h1, h2, h3 { font-weight: 700; }

        /* PRELOADER */
        #preloader { position: fixed; inset: 0; z-index: 10000; background: #044166; display: flex; justify-content: center; align-items: center; flex-direction: column; transition: opacity 0.5s ease; }
        .loader { width: 50px; height: 50px; border: 5px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: var(--gold); animation: spin 1s ease-in-out infinite; }

        /* COVER MODAL */
        #cover-modal {
            position: fixed; inset: 0; z-index: 9999;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://i.postimg.cc/wM4jnvv1/b7b5e3d409641b936619b427405320e2.png');
            background-size: cover; background-position: center;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: all 1s cubic-bezier(0.77, 0, 0.175, 1);
        }
        #cover-modal.hide { transform: translateY(-100%); opacity: 0; }
        
        .profile-cover {
            width: 170px; height: 170px; border-radius: 50%; 
            border: 4px solid var(--gold); object-fit: cover;
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.4); margin-bottom: 20px;
        }

        /* GLASS BOX */
        .glass-box {
            background: rgba(6, 27, 58, 0.45);
            backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
            border-radius: 20px; padding: 25px 20px;
            border: 1px solid rgba(255,255,255,0.15);
            margin-bottom: 25px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative; overflow: hidden;
        }
        .glass-box::after {
            content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.15), transparent);
            transform: skewX(-25deg); animation: shine 6s infinite; pointer-events: none;
        }

        /* ANIMASI CSS */
        .anim-goyang { animation: goyang 5s infinite ease-in-out; }
        .anim-denyut { animation: denyu 2.5s infinite; }
        @keyframes goyang { 0%{transform:rotate(0deg);} 25%{transform:rotate(-3deg);} 75%{transform:rotate(3deg);} 100%{transform:rotate(0deg);} }
        @keyframes denyu { 0%{transform:scale(1);} 50%{transform:scale(1.05);} 100%{transform:scale(1);} }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes shine { 0% { left: -100%; } 20% { left: 200%; } 100% { left: 200%; } }

        /* ANIMASI HEWAN & BALON */
        .interactive-layer { position: fixed; inset: 0; z-index: 1; pointer-events: none; overflow: hidden; }
        .balloon { position: absolute; bottom: -150px; width: 35px; height: 50px; border-radius: 50% 50% 50% 50% / 40% 40% 60% 60%; animation: floatUpBalloon linear infinite; box-shadow: inset -5px -5px 10px rgba(0,0,0,0.2); }
        .balloon::before { content: ''; position: absolute; bottom: -12px; left: 50%; width: 1px; height: 30px; background: rgba(255,255,255,0.4); }
        .bird-fly { position: absolute; color: var(--gold-light); filter: drop-shadow(0 0 10px var(--gold)); animation: flyAcross linear 1 forwards; }

        @keyframes floatUpBalloon {
            0% { transform: translateY(0) rotate(0deg); opacity: 0.8; }
            100% { transform: translateY(-130vh) rotate(15deg); opacity: 0; }
        }
        @keyframes flyAcross {
            0% { transform: translateX(-15vw) translateY(0) scale(0.8); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateX(115vw) translateY(-60px) scale(0.8); opacity: 0; }
        }

        /* GALLERY & UCAPAN AREA */
        .gallery-card { border-radius: 12px; overflow: hidden; border: 2px solid var(--gold); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .float-1 { animation: floatY 4s ease-in-out infinite; }
        .float-2 { animation: floatY 5s ease-in-out infinite reverse; }
        @keyframes floatY { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }

        .wish-box { max-height: 350px; overflow-y: auto; margin-top: 20px; padding-right: 5px; -webkit-overflow-scrolling: touch; }
        .wish-box::-webkit-scrollbar { width: 3px; }
        .wish-box::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 10px; }
        .comment-item { display: flex; gap: 12px; background: rgba(255, 255, 255, 0.08); border-radius: 12px; padding: 12px; margin-bottom: 12px; border-left: 3px solid var(--gold); }
        .comment-avatar { width: 35px; height: 35px; background: var(--gold); color: var(--dark-blue); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1rem; flex-shrink: 0; }
        .comment-content { width: 100%; text-align: left; }
        .comment-name { color: var(--gold); font-weight: bold; font-size: 0.95rem; margin-bottom: 2px; }
        .comment-text { font-size: 0.9rem; color: #eee; line-height: 1.4; }
        .badge-hadir { background: #198754; padding: 1px 6px; border-radius: 4px; font-size: 0.6rem; margin-left: 5px; color: white; }
        .badge-tidak { background: #dc3545; padding: 1px 6px; border-radius: 4px; font-size: 0.6rem; margin-left: 5px; color: white; }

        /* NAVBAR BOTTOM */
        .navbar-bottom {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(150px);
            background: rgba(6, 27, 58, 0.85); padding: 12px 30px; border-radius: 50px;
            display: flex; gap: 25px; z-index: 9000; border: 1px solid var(--gold);
            backdrop-filter: blur(15px); box-shadow: 0 10px 30px rgba(0,0,0,0.5); width: max-content;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .navbar-bottom.show-nav { transform: translateX(-50%) translateY(0); }
        .navbar-bottom a { color: var(--white); font-size: 1.3rem; opacity: 0.5; transition: 0.3s; position: relative; }
        .navbar-bottom a.active { color: var(--gold); opacity: 1; transform: scale(1.2); }
        .navbar-bottom a.active::after { content: ''; position: absolute; bottom: -5px; left: 50%; transform: translateX(-50%); width: 5px; height: 5px; background: var(--gold); border-radius: 50%; }

        .music-btn { position: fixed; top: 20px; right: 20px; width: 45px; height: 45px; background: var(--white); border-radius: 50%; z-index: 101; display: flex; justify-content: center; align-items: center; color: var(--dark-blue); box-shadow: 0 0 20px rgba(255,255,255,0.4); border: 2px solid var(--gold); }
        .ornament { position: absolute; width: 140px; pointer-events: none; z-index: 0; opacity: 0.6; }
        .orn-tl { top: -20px; left: -20px; }
        .orn-tr { top: -20px; right: -20px; transform: scaleX(-1); }
        .time-box { background: var(--dark-blue); border: 1px solid var(--gold); color: var(--gold); padding: 5px 10px; border-radius: 8px; min-width: 60px; }
        
        /* BACKGROUND PARTICLES */
        .particles { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }
        .particle { position: absolute; border-radius: 50%; animation: floatUp linear infinite; }
        @keyframes floatUp { from { transform: translateY(105vh); opacity: 0; } 50% { opacity: 0.8; } to { transform: translateY(-10vh); opacity: 0; } }

    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#nav-menu">

    <div class="particles" id="particles"></div>
    <div class="interactive-layer" id="interactive-layer"></div>

    <div id="preloader">
        <div class="loader"></div>
        <p class="mt-3 small text-white" style="letter-spacing: 2px;">MEMUAT UNDANGAN SULTAN...</p>
    </div>

    <audio id="bg-music" loop>
        <source src="https://files.catbox.moe/cra6x8.mpeg" type="audio/mp3">
    </audio>
    <div class="music-btn" onclick="toggleMusic()">
        <i class="fas fa-compact-disc fa-spin fa-lg" style="animation-duration: 3s;"></i>
    </div>

    <div id="cover-modal">
        <div class="mobile-container w-100 text-center px-3" data-aos="zoom-in" data-aos-duration="1500">
            <div class="position-relative d-inline-block mb-3">
                <img src="https://i.postimg.cc/PJV1KdnW/Whats-App-Image-2026-01-24-at-10-09-20.jpg" class="profile-cover anim-denyut" alt="Cover">
            </div>
            <h6 class="text-uppercase ls-2 mb-2">The Circumcision of</h6>
            <h1 class="font-decor display-3 mb-3" style="text-shadow: 0 4px 10px rgba(0,0,0,0.5);">Wildan Firmansyah</h1>
            <p class="mb-2 small">Kepada Yth. Bapak/Ibu/Saudara/i</p>
            <div class="bg-white text-dark d-inline-block px-4 py-1 rounded-pill fw-bold mb-4 shadow-sm">
                Tamu Undangan
            </div>
            <br>
            <button class="btn btn-warning rounded-pill px-5 py-2 fw-bold shadow-lg" onclick="openInvitation()" style="box-shadow: 0 0 20px rgba(255, 193, 7, 0.6);">
                <i class="fas fa-envelope-open me-2"></i> Buka Undangan
            </button>
        </div>
    </div>

    <div class="mobile-container py-5 px-3">
        
        <img src="https://www.svgrepo.com/show/446212/ornament-border.svg" class="ornament orn-tl anim-goyang">
        <img src="https://www.svgrepo.com/show/446212/ornament-border.svg" class="ornament orn-tr anim-goyang">

        <section id="home" class="text-center mb-5" data-aos="zoom-in-up" data-aos-duration="1200">
            <img src="https://upload.wikimedia.org/wikipedia/commons/2/27/Basmala.svg" width="160" class="mb-4 opacity-75">
            <div class="glass-box" style="border: 1px solid rgba(212, 175, 55, 0.5); position: relative; overflow: hidden;">
                <i class="fas fa-star text-warning position-absolute anim-denyut" style="top: 10px; left: 10px; font-size: 0.6rem;"></i>
                <i class="fas fa-star text-info position-absolute anim-denyut" style="bottom: 10px; right: 10px; font-size: 0.6rem; animation-delay: 1s;"></i>
                
                <p class="fst-italic small mb-0 lh-lg" style="color: #f8f9fa; text-shadow: 0 0 5px rgba(255,255,255,0.2);">
                    "Peristiwa penting dalam perjalanan hidup lelaki muslim adalah menjelang akil baligh, saat manis dalam kenangan sejarah panjang seorang muslim adalah untuk pertama dan cuma sekali ketika ia dikhitan, Ya Allah perkenankan kami mengkhitankan putra kami"
                </p>
            </div>
            
            <h4 class="font-decor mt-4" style="color: var(--gold); text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);">Assalamuâ€™alaikum Wr. Wb.</h4>
            <p class="small mt-2 px-2">Dengan memohon Rahmat Allah SWT, kami mengundang Bapak/Ibu dalam tasyakuran khitan putra kami:</p>
            
            <div data-aos="zoom-in" data-aos-delay="300">
                <img src="https://i.postimg.cc/VkYkzvdQ/IMG-20260124-165353.jpg" class="rounded-circle border border-3 border-warning shadow mt-3 mb-3" width="150" height="150" style="object-fit: cover;">
            </div>
            
            <h1 class="font-decor text-warning display-5">Wildan Firmansyah</h1>
            <p class="mb-0">Putra tercinta dari:</p>
            <p class="fw-bold">Bpk. Iman Firmansyah & Ibu Irmawati</p>
        </section>

        <section id="event" class="text-center mb-5" data-aos="flip-up" data-aos-duration="1000">
            <h2 class="font-decor mb-4">Rangkaian Acara</h2>
            <div class="glass-box">
                <i class="far fa-calendar-alt fa-3x mb-3 text-warning anim-goyang"></i>
                <h4 class="fw-bold">Jumat, 06 Februari 2026</h4>
                <hr class="border-light opacity-50 w-75 mx-auto my-3">
                <h5 class="fw-bold">Pukul 09.00 WIB - Selesai</h5>
                <p class="small text-warning">(Diharapkan hadir tepat waktu)</p>
                <hr class="border-light opacity-50 w-75 mx-auto my-3">
                
                <i class="fas fa-map-marker-alt fa-2x mb-2 text-warning"></i>
                <p class="small">Kediaman Bpk. Iman Firmansyah<br>Green Adelia Residance No.06 Rancakandong Sukamelang Subang</p>
                <a href="https://maps.app.goo.gl/i5JQdCHt3qBpFtcz7?g_st=ac" target="_blank" class="btn btn-warning btn-sm rounded-pill mt-2 px-4 fw-bold shadow">
                    <i class="fas fa-location-arrow me-2"></i> Google Maps
                </a>
            </div>
            <div class="d-flex justify-content-center gap-2 mb-4" id="countdown"></div>
        </section>

        <section id="family" class="text-center mb-5">
            <h2 class="font-decor mb-4" data-aos="fade-down">Our Family</h2>
            <div class="glass-box" data-aos="fade-in">
                <p class="small mb-3">Kebahagiaan kami terasa semakin lengkap dengan kehadiran dan doa dari keluarga besar tercinta.</p>
                
                <div class="row g-3">
                    <div class="col-6" data-aos="fade-right" data-aos-delay="0">
                        <div class="gallery-card float-1">
                            <img src="https://i.postimg.cc/Nfdw7MCp/Whats-App-Image-2026-01-24-at-14-19-19-(2).jpg" class="w-100" style="aspect-ratio: 1/1; object-fit: cover;" alt="1">
                        </div>
                    </div>
                    <div class="col-6" data-aos="fade-left" data-aos-delay="100">
                        <div class="gallery-card float-2">
                            <img src="https://i.postimg.cc/fLQ4T0kT/Whats-App-Image-2026-01-24-at-14-19-19-(1).jpg" class="w-100" style="aspect-ratio: 1/1; object-fit: cover;" alt="2">
                        </div>
                    </div>
                    <div class="col-6" data-aos="zoom-in" data-aos-delay="200">
                        <div class="gallery-card float-1">
                            <img src="https://i.postimg.cc/vTGp5FWj/Whats-App-Image-2026-01-24-at-14-19-19.jpg" class="w-100" style="aspect-ratio: 1/1; object-fit: cover;" alt="3">
                        </div>
                    </div>
                    <div class="col-6" data-aos="zoom-in" data-aos-delay="300">
                        <div class="gallery-card float-2">
                            <img src="https://i.postimg.cc/tR50pJbH/Whats-App-Image-2026-01-24-at-14-19-18-(1).jpg" class="w-100" style="aspect-ratio: 1/1; object-fit: cover;" alt="4">
                        </div>
                    </div>
                    <div class="col-6" data-aos="fade-up-right" data-aos-delay="400">
                        <div class="gallery-card float-1">
                            <img src="https://i.postimg.cc/wj1nXksV/Whats-App-Image-2026-01-24-at-14-19-18.jpg" class="w-100" style="aspect-ratio: 1/1; object-fit: cover;" alt="5">
                        </div>
                    </div>
                    <div class="col-6" data-aos="fade-up-left" data-aos-delay="500">
                        <div class="gallery-card float-2">
                            <img src="https://i.postimg.cc/rpJGzBFP/IMG-20260124-142628.jpg" class="w-100" style="aspect-ratio: 1/1; object-fit: cover;" alt="6">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="gift" class="text-center mb-5" data-aos="zoom-in-up">
            <h2 class="font-decor mb-4">Tanda Kasih</h2>
            <div class="glass-box">
                <p class="small mb-3">Doa restu Anda adalah hadiah terbaik. Jika ingin memberi tanda kasih, dapat melalui:</p>
                <div class="bg-white text-dark p-3 rounded-3 mb-3 mx-auto shadow" style="max-width: 260px;">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Bank_Central_Asia.svg/2560px-Bank_Central_Asia.svg.png" width="50">
                        <span class="badge bg-secondary" style="font-size: 0.6rem;">DEBIT</span>
                    </div>
                    <h5 class="mb-1 fw-bold" style="letter-spacing: 2px;">7750356766</h5>
                    <p class="mb-2 small">a.n Irmawati</p>
                    <button class="btn btn-dark btn-sm rounded-pill w-100" onclick="copyText('7750356766')">
                        <i class="far fa-copy me-2"></i> Salin Nomor
                    </button>
                </div>
            </div>
        </section>

        <section id="wishes" class="text-center mb-5" data-aos="fade-up">
            <h2 class="font-decor mb-4">Kirim Ucapan</h2>
            <div class="glass-box text-start">
                <div class="mb-3">
                    <input type="text" id="input-nama" class="form-control form-control-sm" placeholder="Nama Anda" style="background: rgba(255,255,255,0.9);">
                </div>
                <div class="mb-3">
                    <textarea id="input-pesan" class="form-control form-control-sm" rows="3" placeholder="Tuliskan doa & ucapan..." style="background: rgba(255,255,255,0.9);"></textarea>
                </div>
                <div class="mb-3">
                    <select id="input-hadir" class="form-select form-select-sm" style="background: rgba(255,255,255,0.9);">
                        <option value="1">Hadir</option>
                        <option value="0">Tidak Hadir</option>
                    </select>
                </div>
                <button type="button" onclick="kirimUcapan()" class="btn btn-warning w-100 fw-bold shadow-sm btn-sm py-2">
                    <i class="fas fa-paper-plane me-2"></i> Kirim Ucapan
                </button>

                <hr class="border-light opacity-25 my-4">
                
                <h6 class="font-decor text-center mb-3">Doa Teman-Teman</h6>
                <div class="wish-box" id="list-ucapan"></div>
            </div>
        </section>

        <section id="closing" class="text-center mb-5" data-aos="flip-left" data-aos-duration="2000">
            <div class="glass-box" style="border: 3px double var(--gold); background: rgba(6, 27, 58, 0.7); box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);">
                
                <div class="position-absolute w-100 h-100 top-0 start-0" style="pointer-events: none; z-index: 0;">
                    <i class="fas fa-star text-warning anim-denyut position-absolute" style="top: 10%; left: 5%; font-size: 0.8rem; opacity: 0.4;"></i>
                    <i class="fas fa-moon text-info anim-goyang position-absolute" style="bottom: 15%; right: 8%; font-size: 0.7rem; opacity: 0.4;"></i>
                    <i class="fas fa-heart text-danger anim-denyut position-absolute" style="top: 40%; right: 10%; font-size: 0.5rem; opacity: 0.3;"></i>
                </div>

                <div class="position-relative" style="z-index: 1;">
                    <i class="fas fa-dove text-white mb-3 anim-goyang" style="font-size: 2rem; filter: drop-shadow(0 0 10px #fff);"></i>
                    
                    <p class="mb-4" style="font-size: 0.95rem; line-height: 1.6; letter-spacing: 0.5px;">
                        Atas kehadiran dan do'a restu Bapak/Ibu/Saudara/i <br> kami ucapkan terima kasih.
                    </p>

                    <div class="d-flex align-items-center justify-content-center mb-4">
                        <div style="height: 2px; width: 40px; background: linear-gradient(to right, transparent, #FFD700);"></div>
                        <i class="fas fa-crown mx-3 text-warning" style="filter: drop-shadow(0 0 5px gold);"></i>
                        <div style="height: 2px; width: 40px; background: linear-gradient(to left, transparent, #FFD700);"></div>
                    </div>

                    <h6 class="font-decor text-warning mb-2" style="font-size: 1.1rem; letter-spacing: 2px;">Kami yang berbahagia,</h6>
                    <h4 class="fw-bold text-white mb-0" style="text-shadow: 0 2px 10px rgba(0,0,0,0.8);">
                        Keluarga Bpk Iman Firmansyah <br> & <br> Ibu Irmawati
                    </h4>
                </div>
            </div>
        </section>

        <footer class="text-center small pb-5 mb-5 opacity-75" style="font-size: 0.7rem;">
            <p>Made with <i class="fas fa-heart text-danger"></i> by RnB Network</p>
        </footer>
    </div>

    <div class="navbar-bottom" id="nav-menu">
        <a href="#home" class="active"><i class="fas fa-home"></i></a>
        <a href="#event"><i class="fas fa-calendar-check"></i></a>
        <a href="#family"><i class="fas fa-images"></i></a>
        <a href="#gift"><i class="fas fa-gift"></i></a>
        <a href="#wishes"><i class="fas fa-comment-alt"></i></a>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script>
        // === CONFIGURATION ===
        const ENDPOINT_URL = "https://script.google.com/macros/s/AKfycbzVjoFdJH0OTcHnDQwZ2cCuxHs37SuDU-j5LAmRem19RDGSJvF3Ieeu2Kq-kUY3DbvJ3g/exec"; 
        
        window.addEventListener('load', () => {
            const preloader = document.getElementById('preloader');
            preloader.style.opacity = '0';
            setTimeout(() => { preloader.style.display = 'none'; }, 500);
            loadUcapan();
            createParticles();
            createBalloons();
            spawnBird();
            // INIT AOS
            AOS.init({ duration: 1000, once: true, mirror: false, offset: 50 });
        });

        // BACKGROUND PARTICLES BERWARNA (SPARKLES)
        function createParticles() {
            const container = document.getElementById('particles');
            const colors = ['#D4AF37', '#FFFFFF', '#00BFFF', '#FF69B4', '#ADFF2F']; 
            for(let i=0; i<40; i++) {
                let p = document.createElement('div');
                p.className = 'particle';
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                p.style.left = Math.random() * 100 + 'vw';
                p.style.background = randomColor;
                p.style.width = (Math.random() * 3 + 2) + 'px';
                p.style.height = p.style.width;
                p.style.boxShadow = `0 0 10px ${randomColor}`;
                p.style.animationDuration = (Math.random() * 5 + 3) + 's';
                p.style.animationDelay = (Math.random() * 5) + 's';
                container.appendChild(p);
            }
        }

        // ANIMASI BALON NEON
        function createBalloons() {
            const layer = document.getElementById('interactive-layer');
            const colors = ['#ff0055', '#0099ff', '#ffcc00', '#33cc33', '#cc00ff'];
            for (let i = 0; i < 15; i++) {
                let b = document.createElement('div');
                b.className = 'balloon';
                const c = colors[Math.floor(Math.random() * colors.length)];
                b.style.backgroundColor = c;
                b.style.left = Math.random() * 95 + 'vw';
                b.style.animationDuration = (Math.random() * 10 + 15) + 's';
                b.style.animationDelay = (Math.random() * 10) + 's';
                layer.appendChild(b);
            }
        }

        // BURUNG DARA MEWAH
        function spawnBird() {
            const layer = document.getElementById('interactive-layer');
            let bird = document.createElement('i');
            bird.className = 'fas fa-dove bird-fly';
            bird.style.top = (Math.random() * 40 + 10) + 'vh';
            const duration = (Math.random() * 5 + 8) + 's';
            bird.style.animationDuration = duration;
            layer.appendChild(bird);
            setTimeout(() => bird.remove(), parseFloat(duration) * 1000);
            setTimeout(spawnBird, Math.random() * 10000 + 5000);
        }

        // SMOOTH SCROLL SYSTEM
        let autoScrollActive = false;
        let scrollSpeed = 0.5; 

        function startSmoothScroll() {
            if (autoScrollActive) return;
            autoScrollActive = true;
            smoothScrollLoop();
        }

        function smoothScrollLoop() {
            if (!autoScrollActive) return;
            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 5) {
                autoScrollActive = false;
                return;
            }
            window.scrollBy(0, scrollSpeed);
            requestAnimationFrame(smoothScrollLoop);
        }

        function stopSmoothScroll() { autoScrollActive = false; }
        ['touchstart', 'wheel', 'mousedown', 'keydown'].forEach(evt => window.addEventListener(evt, stopSmoothScroll, { passive: true }));

        // UI LOGIC
        function openInvitation() {
            document.getElementById('cover-modal').classList.add('hide');
            setTimeout(() => { document.getElementById('nav-menu').classList.add('show-nav'); }, 500);
            playMusic();
            window.scrollTo(0,0);
            setTimeout(startSmoothScroll, 1200);
        }

        const music = document.getElementById('bg-music');
        const btnMusic = document.querySelector('.music-btn i');
        let isPlaying = false;
        
        function playMusic() { music.play().catch(() => console.log("Audio blocked")); isPlaying = true; btnMusic.classList.add('fa-spin'); }
        function toggleMusic() {
            if(isPlaying) { music.pause(); btnMusic.classList.remove('fa-spin'); }
            else { music.play(); btnMusic.classList.add('fa-spin'); }
            isPlaying = !isPlaying;
        }

        function copyText(text) {
            navigator.clipboard.writeText(text);
            Swal.fire({ icon: 'success', title: 'Tersalin', showConfirmButton: false, timer: 1000, background: '#061B3A', color: '#fff', toast: true, position: 'bottom' });
        }

        // DATABASE LOGIC
        function loadUcapan() {
            const listBox = document.getElementById('list-ucapan');
            fetch(ENDPOINT_URL)
                .then(r => r.json())
                .then(data => {
                    listBox.innerHTML = "";
                    if(data.length === 0) { listBox.innerHTML = '<div class="text-center small">Jadilah yang pertama memberi ucapan!</div>'; return; }
                    data.reverse().forEach(row => {
                        if (!row || row.length < 4) return;
                        let badge = (row[3] == "1") ? '<span class="badge-hadir">Hadir</span>' : '<span class="badge-tidak">Maaf</span>';
                        let html = `<div class="comment-item"><div class="comment-avatar">${row[1].charAt(0).toUpperCase()}</div><div class="comment-content"><div class="comment-name">${row[1]} ${badge}</div><div class="comment-text">${row[2]}</div><small class="comment-time" style="opacity:0.6">Baru saja</small></div></div>`;
                        listBox.insertAdjacentHTML('beforeend', html);
                    });
                }).catch(e => console.log(e));
        }

        function kirimUcapan() {
            const nama = document.getElementById('input-nama').value;
            const pesan = document.getElementById('input-pesan').value;
            const hadir = document.getElementById('input-hadir').value;
            const btn = document.querySelector('#wishes button');

            if(!nama || !pesan) { Swal.fire({icon: 'warning', text: 'Nama & Pesan wajib diisi', toast: true, position: 'top', timer: 2000}); return; }
            const oriText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            btn.disabled = true;

            fetch(ENDPOINT_URL, { method: "POST", body: JSON.stringify({nama, pesan, hadir}) })
            .then(r => r.json()).then(d => {
                if(d.result === 'success') {
                    Swal.fire({icon: 'success', title: 'Terkirim', showConfirmButton: false, timer: 1500, background: '#061B3A', color: '#fff'});
                    document.getElementById('input-pesan').value = "";
                    loadUcapan();
                }
            }).finally(() => { btn.innerHTML = oriText; btn.disabled = false; });
        }

        // COUNTDOWN
        const targetDate = new Date("Feb 06, 2026 07:00:00").getTime();
        setInterval(() => {
            const diff = targetDate - new Date().getTime();
            if(diff > 0) {
                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);
                document.getElementById('countdown').innerHTML = `<div class="time-box"><h3>${d}</h3><small>Hari</small></div><div class="time-box"><h3>${h}</h3><small>Jam</small></div><div class="time-box"><h3>${m}</h3><small>Menit</small></div><div class="time-box"><h3>${s}</h3><small>Detik</small></div>`;
            }
        }, 1000);
        
        // ACTIVE NAV SCROLL
        const sections = document.querySelectorAll('section');
        const navLi = document.querySelectorAll('.navbar-bottom a');
        window.addEventListener('scroll', () => {
            let current = "";
            sections.forEach(section => { if (pageYOffset >= section.offsetTop - 300) current = section.getAttribute("id"); });
            navLi.forEach(a => { a.classList.remove("active"); if(a.getAttribute("href").includes(current)) a.classList.add("active"); });
        });
    </script>
</body>
</html>